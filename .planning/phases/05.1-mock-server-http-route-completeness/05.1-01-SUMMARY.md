---
phase: 05.1-mock-server-http-route-completeness
plan: 01
subsystem: mock, api
tags: [http, mock-server, taxonomy, questionnaires, registry, routes, pagination]

# Dependency graph
requires:
  - phase: 05-client-facade-package-exports-and-integration
    provides: "Mock server foundation with neuron CRUD, search, and connect routes"
provides:
  - "GET /v1/taxonomy/actions?type= route returning full action objects"
  - "GET /v1/questionnaires/:typeId route returning questionnaire data"
  - "GET /v1/registry/search route with limit/offset pagination (migrated from /v1/search)"
  - "GET /v1/registry/:npi route for direct NPI lookup"
affects: []

# Tech tracking
tech-stack:
  added: []
  patterns:
    - "Static class delegation in route handlers (AxonTaxonomy, AxonQuestionnaires)"
    - "Module-prefixed HTTP paths (/v1/taxonomy/, /v1/questionnaires/, /v1/registry/)"

key-files:
  created: []
  modified:
    - "src/mock/server.ts"
    - "test/mock-server.test.ts"
    - "test/integration/entry-points.test.ts"

key-decisions:
  - "Taxonomy route returns full action objects (not just string IDs) for HTTP consumers without class API access"
  - "Hard swap /v1/search to /v1/registry/search with no backward compatibility"
  - "Route ordering: /v1/registry/search before /v1/registry/:npi to prevent 'search' matching as NPI"

patterns-established:
  - "Static class delegation: route handlers delegate to AxonTaxonomy/AxonQuestionnaires static methods"
  - "Module-prefixed paths: /v1/taxonomy/, /v1/questionnaires/, /v1/registry/ grouping"

requirements-completed: [CLIT-03, REGI-05]

# Metrics
duration: 2min
completed: 2026-02-22
---

# Phase 5.1 Plan 01: Mock Server HTTP Route Completeness Summary

**Added taxonomy actions, questionnaire, registry search (with pagination), and NPI lookup HTTP routes to mock server; migrated search path from /v1/search to /v1/registry/search**

## Performance

- **Duration:** 2 min
- **Started:** 2026-02-22T16:26:46Z
- **Completed:** 2026-02-22T16:28:33Z
- **Tasks:** 2
- **Files modified:** 3

## Accomplishments
- Added 4 new/modified HTTP route handlers to mock server covering taxonomy, questionnaires, and registry modules
- Migrated search endpoint from `/v1/search` to `/v1/registry/search` with `limit`/`offset` pagination support
- Added 9 new test cases covering all new routes (happy paths, error paths, pagination)
- Eliminated all old `/v1/search` references from source and test files (hard swap)

## Task Commits

Each task was committed atomically:

1. **Task 1: Add new route handlers and migrate search path** - `d4b2b72` (feat)
2. **Task 2: Update test references and add tests for new routes** - `80792d2` (test)

## Files Created/Modified
- `src/mock/server.ts` - Added AxonTaxonomy/AxonQuestionnaires imports; 4 route handlers: taxonomy actions, questionnaire lookup, registry search (renamed + pagination), registry NPI lookup
- `test/mock-server.test.ts` - Updated 6 search path references; added 9 new test cases for all new routes
- `test/integration/entry-points.test.ts` - Updated 1 search path reference to /v1/registry/search

## Decisions Made
- Taxonomy route returns full TaxonomyAction objects (with id, description, applicable_types) rather than just string IDs, since HTTP consumers lack class API access for follow-up lookups
- Hard swap of /v1/search to /v1/registry/search with no backward compatibility alias (per CONTEXT.md locked decision)
- Route ordering enforces /v1/registry/search before /v1/registry/:npi regex to prevent "search" being captured as an NPI value

## Deviations from Plan

None - plan executed exactly as written.

## Issues Encountered
None

## User Setup Required
None - no external service configuration required.

## Next Phase Readiness
- All 10 mock server HTTP routes operational (6 existing + 4 new/modified)
- Mock server HTTP API surface is now complete for consumer integration testing
- No blockers or concerns

---
*Phase: 05.1-mock-server-http-route-completeness*
*Completed: 2026-02-22*

## Self-Check: PASSED
